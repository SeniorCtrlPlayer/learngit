X=[1813	1504 15650 8923 3012 6290 6031 4121	1714 7129 5929 12249 7261 11432	14103 28951	8358 12756 15303 12784 2109 4296 11090 10613 14271 951 8041 9054 1314 1890 5155;
    11.526 13.632 15.286 13.292 13.836 13.746 12.132 13.11 12.858 14.022 14.432 18.15 16.162 19.132	15.262 17.75 15.16 18.396 17.17 20.84 17.292 16.656 17.258 19.642 17.566 13.422 14.946 13.584 17.816 18.322	16.016];
Y=[11.85417162 10.50439883 8.867568002 9.296580355 8.995183439 9.909450059 9.372125179 9.354204467 10.81560396 9.34981575 9.057480863 8.728227581 8.792611368 8.875247294 8.982384106 8.999873636 9.110942011 9.020033877 9.282643943 8.749432121 9.098447114 8.955508748 8.347598253 8.092087466 7.78661413 4.221937687 9.139581188 8.321156926 8.041383989 8.548399842 9.18006205];    %用户输入多指标输出矩阵Y
n=size(X',1); m=size(X,1); s=size(Y,1);
epsilon=10^-10;     %定义非阿基米德无穷小?=10-10
f=[zeros(1,n) -epsilon*ones(1,m+s) 1];    %目标函数的系数矩阵 ：? 的系数为0,s-,s+ 的系数为-??e,?的系数为1；
A=zeros(1,n+m+s+1); b=0;     %<=约束；
LB=zeros(n+m+s+1,1); UB=[];   %变量约束；
LB(n+m+s+1)= -Inf;    %-Inf表示下限为负无穷大。
for i=1:n;
    Aeq=[X  eye(m)   zeros(m,s)  -X(:,i)
          Y  zeros(s,m)   -eye(s)     zeros(s,1)];
      beq=[zeros(m, 1 )
          Y(:,i)];
      w(:,i)=linprog(f,A,b,Aeq,beq,LB,UB);  %解线性规划，得DMU的最佳权向量w;
end 
w       %输出最佳权向量
lambda=w(1:n,:)         %输出?
s_minus=w(n+1:n+m,:)     %输出s-
s_plus=w(n+m+1:n+m+s,:)  %输出s+
theta=w(n+m+s+1,:)       %输出?
out=[theta;s_minus;s_plus;w(1,:)]';
